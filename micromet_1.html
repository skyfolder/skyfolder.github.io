<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ë¶€ìƒì„ ìœ„í•œ ë¯¸ê¸°ìƒí•™ ê°œë¡  (Introduction to Micrometeorology)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Scientific Calm (Slate, White, Teal, Indigo) -->
    <!-- Application Structure Plan: Sidebar navigation for linear or non-linear access to 15 chapters. 
         Main content area dynamically updates using JS. 
         Each chapter follows a pattern: Overview -> Key Concepts/Equations -> Interactive Visualization -> Summary.
         This structure aids exam preparation by breaking dense theory into digestible, interactive chunks. -->
    <!-- Visualization & Content Choices: 
         1. Wind Profiles (Ch 6, 10): Logarithmic charts to show height dependency. Interaction: Change z0.
         2. Energy Budget (Ch 2): Bar/Line charts for diurnal cycles. Interaction: Time slider.
         3. Stability (Ch 11): Plotting Richardson number regimes.
         All visualizations use Chart.js/Plotly on Canvas (NO SVG/Mermaid) to ensure performance and interactivity. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc; /* Slate 50 */
            color: #334155; /* Slate 700 */
        }
        h1, h2, h3, .serif {
            font-family: 'Noto Serif KR', serif;
        }
        
        /* Chart Container Styling - Strict constraints per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px; /* Constrain width for readability */
            margin-left: auto;
            margin-right: auto;
            height: 350px; /* Base height */
            max-height: 400px;
            background: white;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        /* Custom Scrollbar for Sidebar */
        .sidebar-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .sidebar-scroll::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .sidebar-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        .sidebar-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .active-nav {
            background-color: #e0e7ff; /* Indigo 100 */
            color: #4338ca; /* Indigo 700 */
            border-right: 4px solid #4338ca;
        }
        
        .equation-box {
            background-color: #f1f5f9;
            border-left: 4px solid #64748b;
            padding: 1rem;
            margin: 1rem 0;
            font-family: 'Times New Roman', serif;
            font-style: italic;
            font-size: 1.1rem;
        }

        .concept-card {
            transition: transform 0.2s;
        }
        .concept-card:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="flex h-screen overflow-hidden text-slate-700">

    <!-- Sidebar Navigation -->
    <aside class="w-64 bg-white border-r border-slate-200 flex flex-col shadow-sm z-10 hidden md:flex">
        <div class="p-6 border-b border-slate-100 bg-slate-50">
            <h1 class="text-xl font-bold text-slate-800 serif">ë¯¸ê¸°ìƒí•™ ê°œë¡ </h1>
            <p class="text-xs text-slate-500 mt-1">í•™ë¶€ìƒ ë° êµ­ê°€ê³ ì‹œ ëŒ€ë¹„ìš©</p>
        </div>
        <nav class="flex-1 overflow-y-auto sidebar-scroll p-2 space-y-1" id="desktop-nav">
            <!-- Nav Items generated by JS -->
        </nav>
        <div class="p-4 border-t border-slate-100 text-xs text-center text-slate-400">
            Interactive Textbook v1.0
        </div>
    </aside>

    <!-- Mobile Header -->
    <div class="md:hidden fixed top-0 w-full bg-white border-b z-20 flex justify-between items-center p-4">
        <h1 class="text-lg font-bold serif">ë¯¸ê¸°ìƒí•™ ê°œë¡ </h1>
        <button id="mobile-menu-btn" class="text-slate-600 focus:outline-none">
            â˜° ëª©ì°¨
        </button>
    </div>

    <!-- Mobile Menu Overlay -->
    <div id="mobile-menu" class="fixed inset-0 bg-slate-800 bg-opacity-75 z-30 hidden">
        <div class="w-64 bg-white h-full shadow-lg flex flex-col">
            <div class="p-4 border-b flex justify-between items-center">
                <span class="font-bold">ëª©ì°¨ (Table of Contents)</span>
                <button id="close-menu-btn" class="text-slate-500">âœ•</button>
            </div>
            <nav class="flex-1 overflow-y-auto p-2" id="mobile-nav">
                <!-- Nav Items generated by JS -->
            </nav>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="flex-1 flex flex-col h-full bg-slate-50 relative pt-16 md:pt-0">
        <div id="content-area" class="flex-1 overflow-y-auto p-4 md:p-10 max-w-5xl mx-auto w-full">
            <!-- Content Injected via JS -->
            <div class="flex items-center justify-center h-full">
                <div class="animate-pulse text-indigo-600 font-bold text-xl">êµì¬ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>
    </main>

    <script>
        // --- DATA STORAGE ---
        const chapters = [
            {
                id: 1,
                title: "Chapter 1. Introduction",
                titleKR: "1ì¥. ì„œë¡ ",
                content: `
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-slate-800 serif mb-4">ë¯¸ê¸°ìƒí•™ì´ë€ ë¬´ì—‡ì¸ê°€?</h2>
                        <p class="mb-4 text-lg leading-relaxed">
                            ë¯¸ê¸°ìƒí•™(Micrometeorology)ì€ ëŒ€ê¸° ê²½ê³„ì¸µ(Atmospheric Boundary Layer, ABL) ë‚´ì—ì„œ ì¼ì–´ë‚˜ëŠ” ì†Œê·œëª¨ ëŒ€ê¸° í˜„ìƒì„ ì—°êµ¬í•˜ëŠ” í•™ë¬¸ì´ë‹¤. 
                            ì´ëŠ” ì§€í‘œë©´ê³¼ ëŒ€ê¸° ì‚¬ì´ì˜ ì—ë„ˆì§€, ìš´ë™ëŸ‰, ë¬¼ì§ˆì˜ êµí™˜ ê³¼ì •ì„ ë‹¤ë£¨ë©°, ì‹œê³µê°„ì  ê·œëª¨(Scale)ì— ëŒ€í•œ ì´í•´ê°€ í•„ìˆ˜ì ì´ë‹¤.
                            ìš°ë¦¬ê°€ ìˆ¨ ì‰¬ê³  ìƒí™œí•˜ëŠ” ê³µê°„ì˜ ê¸°ìƒì„ ë‹¤ë£¨ë¯€ë¡œ ë†ì—…, ì‚°ë¦¼, ë„ì‹œ í™˜ê²½, ëŒ€ê¸° ì˜¤ì—¼ í™•ì‚° ë“± ì‹¤ìƒí™œê³¼ ë°€ì ‘í•œ ê´€ë ¨ì´ ìˆë‹¤.
                        </p>
                        <div class="grid md:grid-cols-2 gap-6 my-8">
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200 concept-card">
                                <h3 class="font-bold text-indigo-600 mb-2">ëŒ€ê¸° ê²½ê³„ì¸µ (ABL)</h3>
                                <p class="text-sm text-slate-600">
                                    ì§€í‘œë©´ì˜ ë§ˆì°°(friction)ê³¼ ê°€ì—´(heating)ì˜ ì˜í–¥ì„ ì§ì ‘ì ìœ¼ë¡œ ë°›ëŠ” ëŒ€ê¸°ì¸µì´ë‹¤. 
                                    ì¼ë°˜ì ìœ¼ë¡œ ì§€í‘œë©´ì—ì„œ ì•½ 1~2km ê³ ë„ê¹Œì§€ë¥¼ ì˜ë¯¸í•˜ë©°, ë‚œë¥˜(Turbulence)ê°€ ì§€ë°°ì ì¸ ì—­í• ì„ í•œë‹¤.
                                </p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200 concept-card">
                                <h3 class="font-bold text-indigo-600 mb-2">ê·œëª¨ (Scale)</h3>
                                <p class="text-sm text-slate-600">
                                    ë¯¸ê¸°ìƒí•™ì€ ì£¼ë¡œ <strong>ë¯¸ì„¸ ê·œëª¨(Microscale)</strong>ë¥¼ ë‹¤ë£¬ë‹¤. 
                                    ê³µê°„ì ìœ¼ë¡œëŠ” 2km ë¯¸ë§Œ, ì‹œê°„ì ìœ¼ë¡œëŠ” 1ì‹œê°„ ë¯¸ë§Œì˜ í˜„ìƒì„ í¬í•¨í•œë‹¤.
                                </p>
                            </div>
                        </div>
                    </div>
                `,
                interactionType: 'none',
                summary: "ë¯¸ê¸°ìƒí•™ì€ ì§€í‘œë©´ ê·¼ì²˜ì˜ ë‚œë¥˜ì™€ í”ŒëŸ­ìŠ¤ë¥¼ ì—°êµ¬í•˜ëŠ” í•™ë¬¸ì´ë©°, ì‹œê°„ê³¼ ê³µê°„ ìŠ¤ì¼€ì¼ì˜ ì´í•´ê°€ ê°€ì¥ ê¸°ì´ˆê°€ ëœë‹¤."
            },
            {
                id: 2,
                title: "Chapter 2. Energy Budget Near the Surface",
                titleKR: "2ì¥. ì§€í‘œë©´ ê·¼ì²˜ì˜ ì—ë„ˆì§€ ìˆ˜ì§€",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ì—ë„ˆì§€ ë³´ì¡´ ë²•ì¹™ì˜ ì ìš©</h2>
                        <p class="mb-4">
                            ì§€í‘œë©´ì—ì„œì˜ ì—ë„ˆì§€ ìˆ˜ì§€(Energy Budget)ëŠ” ë¯¸ê¸°ìƒí•™ì˜ í•µì‹¬ì´ë‹¤. 
                            ì§€í‘œë©´ìœ¼ë¡œ ë“¤ì–´ì˜¤ê³  ë‚˜ê°€ëŠ” ëª¨ë“  ì—ë„ˆì§€ì˜ í•©ì€ 0ì´ì–´ì•¼ í•œë‹¤(ì—ë„ˆì§€ ë³´ì¡´). 
                            ì´ë¥¼ ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.
                        </p>
                        <div class="equation-box text-center text-xl">
                            Rn - G = H + LE
                        </div>
                        <ul class="list-disc list-inside space-y-2 ml-4 text-slate-700 bg-white p-4 rounded border">
                            <li><strong>Rn</strong>: ìˆœë³µì‚¬ (Net Radiation) - ì—ë„ˆì§€ì˜ ê·¼ì›</li>
                            <li><strong>G</strong>: ì§€ì¤‘ ì—´ì „ë„ (Ground Heat Flux) - ë•…ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ì—´</li>
                            <li><strong>H</strong>: í˜„ì—´ í”ŒëŸ­ìŠ¤ (Sensible Heat Flux) - ëŒ€ê¸° ì˜¨ë„ë¥¼ ë†’ì´ëŠ” ì—´</li>
                            <li><strong>LE</strong>: ì ì—´ í”ŒëŸ­ìŠ¤ (Latent Heat Flux) - ë¬¼ì˜ ì¦ë°œì— ì‚¬ìš©ë˜ëŠ” ì—´</li>
                        </ul>
                    </div>
                    
                    <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100 mb-8">
                        <h3 class="font-bold text-lg mb-3 text-indigo-800">ğŸ“Š ëŒ€í™”í˜• í•™ìŠµ: ì£¼ê°„ ì—ë„ˆì§€ ë¶„ë°° ë³€í™”</h3>
                        <p class="text-sm mb-4">ì•„ë˜ ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ <strong>ë³´ì›¬ ë¹„(Bowen Ratio, B = H/LE)</strong>ê°€ ë³€í•  ë•Œ ì—ë„ˆì§€ê°€ ì–´ë–»ê²Œ ë¶„ë°°ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì. (ê±´ì¡°í•œ ì‚¬ë§‰ vs ìŠµí•œ ìˆ²)</p>
                        
                        <div class="flex items-center space-x-4 mb-4">
                            <label class="font-bold text-sm w-32">ìˆ˜ë¶„ ìƒíƒœ:</label>
                            <input type="range" id="moistureSlider" min="0" max="100" value="50" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                            <span id="moistureLabel" class="text-sm font-mono w-24">ë³´í†µ</span>
                        </div>

                        <div class="chart-container">
                            <canvas id="energyChart"></canvas>
                        </div>
                    </div>
                `,
                interactionType: 'energyBudget',
                summary: "ìˆœë³µì‚¬(Rn)ëŠ” í˜„ì—´(H), ì ì—´(LE), ì§€ì¤‘ì—´(G)ë¡œ ë¶„ë°°ë˜ë©°, ê·¸ ë¹„ìœ¨ì€ ì§€í‘œë©´ì˜ ìˆ˜ë¶„ ìƒíƒœ(ë³´ì›¬ ë¹„)ì— ë”°ë¼ ê²°ì •ëœë‹¤."
            },
            {
                id: 3,
                title: "Chapter 3. Radiation Balance Near the Surface",
                titleKR: "3ì¥. ì§€í‘œë©´ ê·¼ì²˜ì˜ ë³µì‚¬ í‰í˜•",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">íƒœì–‘ ë³µì‚¬ì™€ ì§€êµ¬ ë³µì‚¬</h2>
                        <p class="mb-4">
                            ì§€í‘œë©´ì˜ ì—ë„ˆì§€ì›ì€ ê¶ê·¹ì ìœ¼ë¡œ íƒœì–‘ì´ë‹¤. ë³µì‚¬ í‰í˜•ì€ ë‹¨íŒŒ ë³µì‚¬(Shortwave)ì™€ ì¥íŒŒ ë³µì‚¬(Longwave)ì˜ í•©ìœ¼ë¡œ ê³„ì‚°ëœë‹¤.
                        </p>
                        <div class="equation-box text-center">
                            Rn = (Kâ†“ - Kâ†‘) + (Lâ†“ - Lâ†‘) = (1 - Î±)Kâ†“ + L*
                        </div>
                        <p class="mt-4">
                            ì—¬ê¸°ì„œ <strong>ì•Œë² ë„(Albedo, Î±)</strong>ëŠ” ì§€í‘œë©´ì´ íƒœì–‘ë¹›ì„ ë°˜ì‚¬í•˜ëŠ” ë¹„ìœ¨ì´ë‹¤. 
                            ëˆˆ(Fresh Snow)ì€ ì•Œë² ë„ê°€ ë†’ê³ , ì•„ìŠ¤íŒ”íŠ¸ë‚˜ ìˆ²ì€ ì•Œë² ë„ê°€ ë‚®ë‹¤.
                        </p>
                    </div>
                `,
                interactionType: 'none',
                summary: "ìˆœë³µì‚¬ëŠ” ì…ì‚¬/ë°˜ì‚¬ë˜ëŠ” ë‹¨íŒŒ ë³µì‚¬ì™€ ëŒ€ê¸°/ì§€í‘œì—ì„œ ë°©ì¶œë˜ëŠ” ì¥íŒŒ ë³µì‚¬ì˜ ì°¨ì´ë¡œ ê²°ì •ëœë‹¤. ì•Œë² ë„ëŠ” ì´ ê³¼ì •ì—ì„œ ì¤‘ìš”í•œ ë³€ìˆ˜ì´ë‹¤."
            },
            {
                id: 4,
                title: "Chapter 4. Soil Temperatures and Heat Transfer",
                titleKR: "4ì¥. ì§€ì¤‘ ì˜¨ë„ì™€ ì—´ ì „ë‹¬",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ì§€ì¤‘ ì—´ì „ë„ ë°©ì •ì‹</h2>
                        <p class="mb-4">
                            í† ì–‘ ë‚´ë¶€ì˜ ì—´ ì´ë™ì€ ì „ë„(Conduction)ì— ì˜í•´ ì¼ì–´ë‚œë‹¤. ì§€í‘œë©´ ì˜¨ë„ê°€ ì£¼ê¸°ì (í•˜ë£¨ ë˜ëŠ” 1ë…„)ìœ¼ë¡œ ë³€í•  ë•Œ, 
                            ì§€ì¤‘ ì˜¨ë„ëŠ” ê¹Šì´ ë“¤ì–´ê°ˆìˆ˜ë¡ ì§„í­ì´ ê°ì†Œí•˜ê³  ìœ„ìƒì´ ì§€ì—°ëœë‹¤(Damping & Lagging).
                        </p>
                        <div class="equation-box text-center">
                            T(z, t) = T_avg + A_0 exp(-z/D) sin(Ï‰t - z/D)
                        </div>
                        <p class="text-sm text-slate-600 mt-2 text-center">D: ê°ì‡  ê¹Šì´ (Damping Depth)</p>
                    </div>
                    
                    <div class="bg-white p-6 rounded-xl border border-slate-200 mb-8">
                        <h3 class="font-bold text-lg mb-3">ğŸ“ˆ ì§€ì¤‘ ì˜¨ë„ í”„ë¡œíŒŒì¼ ì‹œë®¬ë ˆì´ì…˜</h3>
                        <p class="text-sm mb-4">ê¹Šì´ì— ë”°ë¥¸ ì˜¨ë„ ë³€í™”ë¥¼ ê´€ì°°í•´ë³´ì. ì§€í‘œë©´(0m)ì˜ ì˜¨ë„ ë³€í™”ê°€ ì‹¬í•  ë•Œ, ê¹Šì€ ê³³(0.5m)ì€ ì–´ë–»ê²Œ ë°˜ì‘í•˜ëŠ”ê°€?</p>
                        <div class="chart-container">
                            <canvas id="soilTempChart"></canvas>
                        </div>
                    </div>
                `,
                interactionType: 'soilTemp',
                summary: "ì§€ì¤‘ ì˜¨ë„ëŠ” ê¹Šì´ì— ë”°ë¼ ì§„í­ì´ ì§€ìˆ˜ì ìœ¼ë¡œ ê°ì†Œí•˜ë©°, ìµœê³ /ìµœì € ì˜¨ë„ê°€ ë‚˜íƒ€ë‚˜ëŠ” ì‹œê°„ì€ ê¹Šì–´ì§ˆìˆ˜ë¡ ëŠ¦ì–´ì§„ë‹¤."
            },
            {
                id: 5,
                title: "Chapter 5. Air Temperature and Humidity in the PBL",
                titleKR: "5ì¥. PBL ë‚´ì˜ ê¸°ì˜¨ê³¼ ìŠµë„",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ì˜¨ìœ„ (Potential Temperature, Î¸)</h2>
                        <p class="mb-4">
                            ëŒ€ê¸°ì˜ ì•ˆì •ë„ë¥¼ íŒë‹¨í•  ë•Œ ê¸°ì˜¨(T) ëŒ€ì‹  ì˜¨ìœ„(Î¸)ë¥¼ ì‚¬ìš©í•œë‹¤. ì˜¨ìœ„ëŠ” ê³µê¸° ë©ì–´ë¦¬ë¥¼ ë‹¨ì—´ì ìœ¼ë¡œ 1000hPaë¡œ ì´ë™ì‹œì¼°ì„ ë•Œì˜ ì˜¨ë„ì´ë‹¤.
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center text-sm">
                            <div class="p-4 bg-red-50 rounded border border-red-100">
                                <strong>ë¶ˆì•ˆì • (Unstable)</strong><br>
                                âˆ‚Î¸/âˆ‚z < 0<br>
                                ë‚® ì‹œê°„ëŒ€, í™œë°œí•œ ëŒ€ë¥˜
                            </div>
                            <div class="p-4 bg-gray-50 rounded border border-gray-200">
                                <strong>ì¤‘ë¦½ (Neutral)</strong><br>
                                âˆ‚Î¸/âˆ‚z â‰ˆ 0<br>
                                ê°•í’, íë¦° ë‚ 
                            </div>
                            <div class="p-4 bg-blue-50 rounded border border-blue-100">
                                <strong>ì•ˆì • (Stable)</strong><br>
                                âˆ‚Î¸/âˆ‚z > 0<br>
                                ë°¤ ì‹œê°„ëŒ€, ê¸°ì˜¨ ì—­ì „ì¸µ
                            </div>
                        </div>
                    </div>
                `,
                interactionType: 'none',
                summary: "PBL ë‚´ ì—°ì§ êµ¬ì¡°ëŠ” ì˜¨ìœ„(Î¸)ì˜ ê¸°ìš¸ê¸°ì— ë”°ë¼ ê²°ì •ë˜ë©°, ì´ëŠ” ì˜¤ì—¼ ë¬¼ì§ˆì˜ í™•ì‚°ê³¼ ë‚œë¥˜ ê°•ë„ì— ê²°ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹œë‹¤."
            },
            {
                id: 6,
                title: "Chapter 6. Wind Distribution in the PBL",
                titleKR: "6ì¥. PBL ë‚´ì˜ ë°”ëŒ ë¶„í¬",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ë¡œê·¸ ë°”ëŒ ë²•ì¹™ (Log Wind Profile)</h2>
                        <p class="mb-4">
                            ì¤‘ë¦½ ëŒ€ê¸° ì¡°ê±´ì—ì„œ ì§€í‘œë©´ ê·¼ì²˜ì˜ í‰ê·  í’ì†ì€ ë†’ì´ì˜ ë¡œê·¸ì— ë¹„ë¡€í•˜ì—¬ ì¦ê°€í•œë‹¤.
                        </p>
                        <div class="equation-box text-center">
                            u(z) = (u* / k) * ln(z / z0)
                        </div>
                        <ul class="list-disc list-inside ml-4 text-slate-700 bg-white p-4 rounded border mb-4">
                            <li><strong>u(z)</strong>: ë†’ì´ zì—ì„œì˜ í’ì†</li>
                            <li><strong>u*</strong>: ë§ˆì°° ì†ë„ (Friction Velocity)</li>
                            <li><strong>k</strong>: í° ì¹¼ë§Œ ìƒìˆ˜ (ì•½ 0.4)</li>
                            <li><strong>z0</strong>: ê±°ì¹ ê¸° ê¸¸ì´ (Roughness Length)</li>
                        </ul>
                    </div>

                    <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100 mb-8">
                        <h3 class="font-bold text-lg mb-3 text-indigo-800">ğŸ’¨ ì§€í‘œë©´ ê±°ì¹ ê¸°ì— ë”°ë¥¸ ë°”ëŒ ë³€í™”</h3>
                        <p class="text-sm mb-4">ê±°ì¹ ê¸° ê¸¸ì´(z0)ë¥¼ ë³€ê²½í•˜ì—¬ ë¹™íŒ ìœ„(ë‚®ì€ z0)ì™€ ìˆ² ìœ„(ë†’ì€ z0)ì˜ ë°”ëŒ í”„ë¡œíŒŒì¼ì„ ë¹„êµí•´ë³´ì.</p>
                        
                        <div class="flex items-center space-x-4 mb-4">
                            <label class="font-bold text-sm w-32">ê±°ì¹ ê¸° (z0):</label>
                            <input type="range" id="roughnessSlider" min="1" max="100" value="10" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                            <span id="roughnessLabel" class="text-sm font-mono w-32">0.01 m</span>
                        </div>

                        <div class="chart-container">
                            <canvas id="windChart"></canvas>
                        </div>
                    </div>
                `,
                interactionType: 'windProfile',
                summary: "ì§€í‘œë©´ ê·¼ì²˜ì˜ ë°”ëŒì€ ë§ˆì°°ë ¥ì— ì˜í•´ ë¡œê·¸ í•¨ìˆ˜ í˜•íƒœë¡œ ì¦ê°€í•˜ë©°, ì§€í‘œë©´ì´ ê±°ì¹ ìˆ˜ë¡(z0ê°€ í´ìˆ˜ë¡) ë°”ëŒì€ ë” ëŠë¦¬ê²Œ ì¦ê°€í•œë‹¤."
            },
            {
                id: 7,
                title: "Chapter 7. An Introduction to Viscous Flows",
                titleKR: "7ì¥. ì ì„± ìœ ë™ ê°œë¡ ",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ì¸µë¥˜ì™€ ë‚œë¥˜</h2>
                        <p class="mb-4">
                            ëŒ€ê¸°ì˜ íë¦„ì€ ì ì„±ë ¥ê³¼ ê´€ì„±ë ¥ì˜ ë¹„ìœ¨ì¸ <strong>ë ˆì´ë†€ì¦ˆ ìˆ˜(Reynolds Number, Re)</strong>ì— ì˜í•´ ê²°ì •ëœë‹¤.
                        </p>
                        <div class="equation-box text-center">
                            Re = UL / Î½
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                            <div class="p-4 bg-white border rounded shadow-sm">
                                <h4 class="font-bold text-blue-600">ì¸µë¥˜ (Laminar Flow)</h4>
                                <p class="text-sm text-slate-600">Reê°€ ì‘ì„ ë•Œ. ìœ ì²´ê°€ ê·œì¹™ì ì¸ ì¸µì„ ì´ë£¨ë©° íë¦„. ì ì„±ë ¥ì´ ì§€ë°°ì .</p>
                            </div>
                            <div class="p-4 bg-white border rounded shadow-sm">
                                <h4 class="font-bold text-red-600">ë‚œë¥˜ (Turbulent Flow)</h4>
                                <p class="text-sm text-slate-600">Reê°€ í´ ë•Œ (ëŒ€ë¶€ë¶„ì˜ ëŒ€ê¸°). ë¶ˆê·œì¹™í•˜ê³  í˜¼ëˆìŠ¤ëŸ¬ìš´ íë¦„. ê´€ì„±ë ¥ì´ ì§€ë°°ì .</p>
                            </div>
                        </div>
                    </div>
                `,
                interactionType: 'none',
                summary: "ëŒ€ê¸°ëŠ” ëŒ€ë¶€ë¶„ ë†’ì€ ë ˆì´ë†€ì¦ˆ ìˆ˜ë¥¼ ê°€ì§€ë©°, ì´ëŠ” ì ì„±ë³´ë‹¤ ê´€ì„±ì— ì˜í•œ ë‚œë¥˜ íš¨ê³¼ê°€ í›¨ì”¬ ì¤‘ìš”í•¨ì„ ì˜ë¯¸í•œë‹¤."
            },
            {
                id: 8,
                title: "Chapter 8. Fundamentals of Turbulence",
                titleKR: "8ì¥. ë‚œë¥˜ì˜ ê¸°ì´ˆ",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ë ˆì´ë†€ì¦ˆ ë¶„í•´ (Reynolds Decomposition)</h2>
                        <p class="mb-4">
                            ë‚œë¥˜ë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ ë‹¤ë£¨ê¸° ìœ„í•´ ëª¨ë“  ë³€ìˆ˜ë¥¼ 'í‰ê· 'ê³¼ 'ë³€ë™(fluctuation)' ì„±ë¶„ìœ¼ë¡œ ë¶„ë¦¬í•œë‹¤.
                        </p>
                        <div class="equation-box text-center">
                            u = \u003Cu\u003E + u'
                        </div>
                        <p class="mb-4">
                            ì—¬ê¸°ì„œ <u>\u003Cu\u003E</u>ëŠ” í‰ê· ê°’, <u>u'</u>ëŠ” ë‚œë¥˜ì— ì˜í•œ ë³€ë™ê°’ì´ë‹¤. 
                            ì´ ë³€ë™ ì„±ë¶„(u', w', T')ë“¤ì˜ ìƒê´€ê´€ê³„(Covariance)ê°€ ë°”ë¡œ ìˆ˜ì†¡ëŸ‰(Flux)ì„ ë§Œë“¤ì–´ë‚¸ë‹¤.
                        </p>
                    </div>
                    
                    <div class="bg-white p-6 rounded-xl border border-slate-200 mb-8">
                        <h3 class="font-bold text-lg mb-3">ğŸŒŠ ë‚œë¥˜ ë°ì´í„° ì‹œê°í™”</h3>
                        <p class="text-sm mb-4">ì‹¤ì œ ë°”ëŒ ë°ì´í„°(ê°€ìƒ)ë¥¼ ë³´ë©° í‰ê· ê³¼ ë³€ë™ì„ ì´í•´í•´ë³´ì.</p>
                        <div class="chart-container">
                            <canvas id="turbulenceChart"></canvas>
                        </div>
                    </div>
                `,
                interactionType: 'turbulence',
                summary: "ë‚œë¥˜ëŠ” í‰ê·  íë¦„ì— ê²¹ì³ì§„ ë¶ˆê·œì¹™í•œ ë³€ë™ì´ë‹¤. ìš°ë¦¬ëŠ” í†µê³„ì  ë°©ë²•(í‰ê· , ë¶„ì‚°, ê³µë¶„ì‚°)ì„ í†µí•´ ë‚œë¥˜ë¥¼ ì •ëŸ‰í™”í•œë‹¤."
            },
            {
                id: 9,
                title: "Chapter 9. Models and Theories of Turbulence",
                titleKR: "9ì¥. ë‚œë¥˜ì˜ ëª¨ë¸ê³¼ ì´ë¡ ",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">K-ì´ë¡  (K-Theory)</h2>
                        <p class="mb-4">
                            ë‚œë¥˜ì— ì˜í•œ ìˆ˜ì†¡ì„ ë¶„ì í™•ì‚°ê³¼ ìœ ì‚¬í•˜ê²Œ ëª¨ë¸ë§í•˜ëŠ” ë°©ë²•ì´ë‹¤. ì´ë¥¼ 'ê²½ë„ ìˆ˜ì†¡ ì´ë¡ (Gradient Transport Theory)'ì´ë¼ê³ ë„ í•œë‹¤.
                        </p>
                        <div class="equation-box text-center">
                            Flux = -K * (dC / dz)
                        </div>
                        <p class="mt-4">
                            ì—¬ê¸°ì„œ <strong>K</strong>ëŠ” ë‚œë¥˜ í™•ì‚° ê³„ìˆ˜(Eddy Diffusivity)ì´ë‹¤. 
                            ë†ë„(C)ê°€ ë†’ì€ ê³³ì—ì„œ ë‚®ì€ ê³³ìœ¼ë¡œ ì´ë™í•˜ë©°, ê·¸ ì´ë™ëŸ‰ì€ ë†ë„ ê¸°ìš¸ê¸°ì™€ Kê°’ì— ë¹„ë¡€í•œë‹¤.
                            í•˜ì§€ë§Œ í° ì—ë””(Large Eddy)ê°€ ìˆëŠ” ëŒ€ë¥˜ ì¡°ê±´ì—ì„œëŠ” ì´ ì´ë¡ ì´ ì˜ ë§ì§€ ì•ŠëŠ”ë‹¤.
                        </p>
                    </div>
                `,
                interactionType: 'none',
                summary: "K-ì´ë¡ ì€ ë‚œë¥˜ í”ŒëŸ­ìŠ¤ë¥¼ í‰ê· ê°’ì˜ ê¸°ìš¸ê¸°ë¡œ í‘œí˜„í•˜ëŠ” ê°€ì¥ ê¸°ì´ˆì ì¸ íì‡„(Closure) ë°©ë²•ì´ë‹¤."
            },
            {
                id: 10,
                title: "Chapter 10. Near-neutral Boundary Layers",
                titleKR: "10ì¥. ê·¼ì¤‘ë¦½ ê²½ê³„ì¸µ",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ì¤‘ë¦½ ì¡°ê±´ì˜ íŠ¹ì§•</h2>
                        <p class="mb-4">
                            ë¶€ë ¥ì— ì˜í•œ íš¨ê³¼ê°€ ë¬´ì‹œí•  ìˆ˜ ìˆì„ ì •ë„ë¡œ ì‘ê³ , ì˜¤ì§ ê¸°ê³„ì  ì „ë‹¨ë ¥(Shear)ë§Œì´ ë‚œë¥˜ë¥¼ ìƒì„±í•˜ëŠ” ì¡°ê±´ì´ë‹¤.
                            ì£¼ë¡œ ê°•í’ì´ ë¶ˆê±°ë‚˜ íë¦° ë‚  ë°œìƒí•œë‹¤. ì´ë•ŒëŠ” ë¡œê·¸ ë°”ëŒ ë²•ì¹™ì´ ì „ êµ¬ê°„ì—ì„œ ì˜ ì ìš©ëœë‹¤.
                        </p>
                        <p class="text-sm text-slate-500 bg-slate-100 p-2 rounded">
                            Tip: êµ­ê°€ ê³ ì‹œ ë¬¸ì œì—ì„œ 'ì¤‘ë¦½ ì¡°ê±´'ì´ë¼ê³  ëª…ì‹œë˜ë©´ ë¶€ë ¥í•­(g/T)ì„ 0ìœ¼ë¡œ ë†“ê³  ë¬¸ì œë¥¼ í‘¼ë‹¤.
                        </p>
                    </div>
                `,
                interactionType: 'none',
                summary: "ê·¼ì¤‘ë¦½ ê²½ê³„ì¸µì€ ë¶€ë ¥ì˜ ì˜í–¥ì´ ì—†ê³  ê¸°ê³„ì  ë‚œë¥˜ë§Œ ì¡´ì¬í•˜ëŠ” ì´ìƒì ì¸ ìƒíƒœë¡œ, ì´ë¡ ì  ëª¨ë¸ì˜ ê¸°ì¤€ì ì´ ëœë‹¤."
            },
            {
                id: 11,
                title: "Chapter 11. Thermally Stratified Surface Layer",
                titleKR: "11ì¥. ì—´ì ìœ¼ë¡œ ì„±ì¸µí™”ëœ ì ‘ì§€ì¸µ",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ëª¨ë‹Œ-ì˜¤ë¸Œì½”í”„ ìƒì‚¬ ì´ë¡  (MOST)</h2>
                        <p class="mb-4">
                            ì¤‘ë¦½ì´ ì•„ë‹Œ ê²½ìš°(ë¶ˆì•ˆì • ë˜ëŠ” ì•ˆì •), ë¡œê·¸ ë²•ì¹™ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤. ì´ë•Œ ë¬´ì°¨ì› ë†’ì´ <strong>Î¶ = z/L</strong>ê°€ ì‚¬ìš©ëœë‹¤.
                            ì—¬ê¸°ì„œ Lì€ <strong>ëª¨ë‹Œ-ì˜¤ë¸Œì½”í”„ ê¸¸ì´(Obukhov Length)</strong>ì´ë‹¤.
                        </p>
                        <div class="equation-box text-center text-sm md:text-base">
                            Ï†_m(Î¶) = (kz/u*) * (âˆ‚u/âˆ‚z)
                        </div>
                        <p class="mt-4">
                            ë¬´ì°¨ì› ë°”ëŒ ì‹œì–´(Ï†_m)ëŠ” ì•ˆì •ë„(Î¶)ë§Œì˜ í•¨ìˆ˜ì´ë‹¤. ì´ë¥¼ í†µí•´ ë‹¤ì–‘í•œ ì•ˆì •ë„ ì¡°ê±´ì—ì„œì˜ ë°”ëŒ í”„ë¡œíŒŒì¼ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆë‹¤.
                        </p>
                    </div>

                    <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100 mb-8">
                        <h3 class="font-bold text-lg mb-3 text-indigo-800">âš–ï¸ ì•ˆì •ë„ì™€ ë¦¬ì°¨ë“œìŠ¨ ìˆ˜</h3>
                        <p class="text-sm mb-4">ë¦¬ì°¨ë“œìŠ¨ ìˆ˜(Ri)ëŠ” ë‚œë¥˜ê°€ ìƒì„±ë ì§€(ë¶ˆì•ˆì •) ì†Œë©¸ë ì§€(ì•ˆì •)ë¥¼ íŒë³„í•˜ëŠ” ì§€í‘œì´ë‹¤. Ri &lt; 0.25 ì¼ ë•Œ ë‚œë¥˜ê°€ ìœ ì§€ëœë‹¤.</p>
                        <div class="chart-container">
                            <canvas id="stabilityChart"></canvas>
                        </div>
                    </div>
                `,
                interactionType: 'stability',
                summary: "ì„±ì¸µí™”ëœ ëŒ€ê¸°ì—ì„œëŠ” ë¶€ë ¥ì´ ë‚œë¥˜ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ì–µì œí•˜ë©°, MOST ì´ë¡ ì„ í†µí•´ ì´ë¥¼ ì •ëŸ‰ì ìœ¼ë¡œ ë³´ì •í•œë‹¤."
            },
            {
                id: 12,
                title: "Chapter 12. Evaporation from Homogeneous Surfaces",
                titleKR: "12ì¥. ê· ì§ˆí•œ ì§€í‘œë©´ì—ì„œì˜ ì¦ë°œ",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">íœë§Œ-ëª¬í‹°ìŠ¤ (Penman-Monteith) ë°©ì •ì‹</h2>
                        <p class="mb-4">
                            ì¦ë°œì‚°ëŸ‰(Evapotranspiration)ì„ ê³„ì‚°í•˜ëŠ” ê°€ì¥ í‘œì¤€ì ì¸ ì‹ì´ë‹¤. 
                            ì—ë„ˆì§€ ìˆ˜ì§€ í•­(ë³µì‚¬ ì—ë„ˆì§€)ê³¼ ê³µê¸°ì—­í•™ì  í•­(ë°”ëŒ, ìŠµë„)ì„ ëª¨ë‘ ê³ ë ¤í•œë‹¤.
                        </p>
                        <div class="p-4 bg-white border rounded shadow-sm">
                            <ul class="list-disc list-inside space-y-2 text-sm text-slate-700">
                                <li><strong>ì—ë„ˆì§€ í•­:</strong> íƒœì–‘ ë³µì‚¬ ì—ë„ˆì§€ê°€ ë¬¼ì„ ì¦ë°œì‹œí‚´</li>
                                <li><strong>ê³µê¸°ì—­í•™ì  í•­:</strong> ê±´ì¡°í•œ ë°”ëŒì´ ìˆ˜ì¦ê¸°ë¥¼ ì‹¤ì–´ ë‚˜ë¦„</li>
                                <li><strong>ì €í•­(Resistance):</strong> ê¸°ê³µ ì €í•­(ì‹ë¬¼)ê³¼ ê³µê¸°ì—­í•™ì  ì €í•­ì´ ì¦ë°œì„ ì–µì œí•¨</li>
                            </ul>
                        </div>
                    </div>
                `,
                interactionType: 'none',
                summary: "ì¦ë°œì€ ì—ë„ˆì§€ ê³µê¸‰ê³¼ ìˆ˜ì¦ê¸° ì œê±°(ë°”ëŒ) ê³¼ì •ì˜ ê²°í•©ì´ë©°, ì—ë”” ê³µë¶„ì‚°(Eddy Covariance) ë°©ë²•ìœ¼ë¡œ ì§ì ‘ ì¸¡ì •í•  ìˆ˜ ìˆë‹¤."
            },
            {
                id: 13,
                title: "Chapter 13. Stratified Atmospheric Boundary Layers",
                titleKR: "13ì¥. ì„±ì¸µí™”ëœ ëŒ€ê¸° ê²½ê³„ì¸µ",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">í˜¼í•©ì¸µì˜ ì„±ì¥ (Mixed Layer Growth)</h2>
                        <p class="mb-4">
                            ë‚® ë™ì•ˆ ì§€í‘œë©´ ê°€ì—´ë¡œ ì¸í•´ ëŒ€ë¥˜ê°€ í™œë°œí•´ì§€ë©´ <strong>í˜¼í•©ì¸µ(Mixed Layer)</strong>ì´ ë°œë‹¬í•œë‹¤.
                            í˜¼í•©ì¸µ ìƒë¶€ì—ëŠ” ì—­ì „ì¸µ(Inversion Layer)ì´ ëšœê»‘ ì—­í• ì„ í•˜ë©° ë®ê³  ìˆë‹¤.
                            ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ê°€ì—´ëœ ê³µê¸° ë©ì–´ë¦¬(Thermals)ê°€ ì—­ì „ì¸µì„ ëš«ê³  ì˜¬ë¼ê°€ë©°(Entrainment) í˜¼í•©ì¸µì˜ ë†’ì´(zi)ê°€ ë†’ì•„ì§„ë‹¤.
                        </p>
                        <div class="bg-gray-100 p-4 rounded text-center text-sm font-mono">
                            d(zi)/dt â‰ˆ Heat Flux / Stratification Strength
                        </div>
                    </div>
                `,
                interactionType: 'none',
                summary: "ë‚®ì—ëŠ” ëŒ€ë¥˜ í˜¼í•©ì¸µì´ ì„±ì¥í•˜ê³ , ë°¤ì—ëŠ” ì§€í‘œ ëƒ‰ê°ìœ¼ë¡œ ì¸í•´ ì•ˆì •í•œ ì•¼ê°„ ê²½ê³„ì¸µ(NBL)ì´ í˜•ì„±ë˜ëŠ” ì¼ë³€í™”ê°€ ëšœë ·í•˜ë‹¤."
            },
            {
                id: 14,
                title: "Chapter 14. Nonhomogeneous Boundary Layers",
                titleKR: "14ì¥. ë¹„ê· ì§ˆ ê²½ê³„ì¸µ",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ë‚´ë¶€ ê²½ê³„ì¸µ (Internal Boundary Layer, IBL)</h2>
                        <p class="mb-4">
                            ê³µê¸°ê°€ ì„±ì§ˆì´ ë‹¤ë¥¸ í‘œë©´(ì˜ˆ: ìœ¡ì§€ â†’ ë°”ë‹¤, ìˆ² â†’ ì´ˆì›)ìœ¼ë¡œ ì´ë™í•  ë•Œ, 
                            ìƒˆë¡œìš´ í‘œë©´ì˜ ì˜í–¥ì„ ë°›ì•„ ë³€í™”í•˜ê¸° ì‹œì‘í•˜ëŠ” ì¸µì„ ë‚´ë¶€ ê²½ê³„ì¸µì´ë¼ê³  í•œë‹¤.
                        </p>
                        <div class="flex flex-col items-center p-4 bg-white border rounded mt-4">
                            <div class="text-lg font-bold mb-2">ì§€í‘œë©´ ë³€í™” (Step Change)</div>
                            <div class="w-full h-2 bg-gradient-to-r from-green-600 to-blue-400 mb-1"></div>
                            <div class="flex justify-between w-full text-sm">
                                <span>ìˆ² (ê±°ì¹¨)</span>
                                <span>í˜¸ìˆ˜ (ë§¤ë„ëŸ¬ì›€)</span>
                            </div>
                            <p class="mt-2 text-sm text-slate-600">
                                ê²½ê³„ë©´ì„ ì§€ë‚˜ë©´ì„œ ì•„ë˜ìª½ë¶€í„° ìƒˆë¡œìš´ ìœ ì²´ íŠ¹ì„±ì´ ì „íŒŒë˜ì–´ ì˜¬ë¼ê°„ë‹¤. 
                                IBLì˜ ë†’ì´ëŠ” ê±°ë¦¬ì— ë”°ë¼ ì•½ x^0.8 ì •ë„ë¡œ ì„±ì¥í•œë‹¤.
                            </p>
                        </div>
                    </div>
                `,
                interactionType: 'none',
                summary: "ì‹¤ì œ ì§€í‘œë©´ì€ ê· ì§ˆí•˜ì§€ ì•Šë‹¤. ì§€í‘œ íŠ¹ì„±ì´ ê¸‰ë³€í•˜ëŠ” ê³³ì—ì„œëŠ” ë‚´ë¶€ ê²½ê³„ì¸µ(IBL)ì´ í˜•ì„±ë˜ì–´ íë¦„ì´ ì¡°ì •ëœë‹¤."
            },
            {
                id: 15,
                title: "Chapter 15. Agricultural and Forest Micrometeorology",
                titleKR: "15ì¥. ë†ë¦¼ ë¯¸ê¸°ìƒí•™",
                content: `
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800 serif mb-4">ìºë…¸í”¼ ìœ ë™ (Canopy Flow)</h2>
                        <p class="mb-4">
                            ìˆ²ì´ë‚˜ ë†ì‘ë¬¼ êµ°ë½(Canopy) ë‚´ë¶€ì˜ ë°”ëŒì€ ë¡œê·¸ ë²•ì¹™ì„ ë”°ë¥´ì§€ ì•ŠëŠ”ë‹¤. 
                            ì‹ìƒì— ì˜í•œ í•­ë ¥(Drag) ë•Œë¬¸ì— ë°”ëŒì´ ê¸‰ê²©íˆ ì•½í•´ì§„ë‹¤.
                        </p>
                        <div class="equation-box text-center">
                            u(z) = (u* / k) * ln((z - d) / z0)
                        </div>
                        <p class="mt-4">
                            ì‹ìƒ ìœ„ì—ì„œëŠ” <strong>ì˜ë©´ë³€ìœ„(Zero-plane displacement, d)</strong>ë¥¼ ë„ì…í•˜ì—¬ ë¡œê·¸ ë²•ì¹™ì„ ìˆ˜ì •í•´ ì‚¬ìš©í•œë‹¤.
                            ì¼ë°˜ì ìœ¼ë¡œ dëŠ” ì‹ìƒ ë†’ì´(h)ì˜ ì•½ 0.7ë°° ì •ë„ì´ë‹¤ (d â‰ˆ 0.7h).
                        </p>
                    </div>
                `,
                interactionType: 'none',
                summary: "ì‹ìƒì€ ìš´ë™ëŸ‰ì„ í¡ìˆ˜í•˜ê³  ì—´ê³¼ ìˆ˜ë¶„ì„ ë°©ì¶œí•˜ëŠ” í™œì„±ë©´ì´ë‹¤. ì˜ë©´ë³€ìœ„(d) ê°œë…ì€ ì‹ìƒ ìœ„ì˜ íë¦„ì„ í•´ì„í•˜ëŠ” ë° í•„ìˆ˜ì ì´ë‹¤."
            }
        ];

        // --- GLOBAL STATE ---
        let currentChapterIndex = 0;
        let chartInstance = null; // To hold Chart.js instances and destroy them properly

        // --- DOM ELEMENTS ---
        const desktopNav = document.getElementById('desktop-nav');
        const mobileNav = document.getElementById('mobile-nav');
        const contentArea = document.getElementById('content-area');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const closeMenuBtn = document.getElementById('close-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        // --- NAVIGATION LOGIC ---
        function renderNav() {
            const createNavItem = (chapter, index) => {
                const btn = document.createElement('button');
                btn.className = `w-full text-left px-4 py-3 rounded-md text-sm transition-colors ${index === currentChapterIndex ? 'active-nav font-bold' : 'text-slate-600 hover:bg-slate-100'}`;
                btn.innerText = chapter.titleKR; // Use Korean Title for menu
                btn.onclick = () => {
                    currentChapterIndex = index;
                    loadChapter(index);
                    toggleMobileMenu(false);
                    renderNav(); // Re-render to update active state
                };
                return btn;
            };

            desktopNav.innerHTML = '';
            mobileNav.innerHTML = '';

            chapters.forEach((chapter, index) => {
                desktopNav.appendChild(createNavItem(chapter, index));
                mobileNav.appendChild(createNavItem(chapter, index));
            });
        }

        function toggleMobileMenu(show) {
            mobileMenu.classList.toggle('hidden', !show);
        }

        // --- CONTENT RENDERING ---
        function loadChapter(index) {
            const chapter = chapters[index];
            
            // Cleanup previous chart
            if (chartInstance) {
                chartInstance.destroy();
                chartInstance = null;
            }

            // Build HTML
            contentArea.innerHTML = `
                <div class="fade-in">
                    <div class="border-b border-slate-200 pb-4 mb-6">
                        <h4 class="text-sm font-bold text-indigo-600 uppercase tracking-wide mb-1">${chapter.title}</h4>
                        <h1 class="text-3xl md:text-4xl font-bold text-slate-900 serif">${chapter.titleKR}</h1>
                    </div>
                    
                    <div class="prose max-w-none text-slate-700">
                        ${chapter.content}
                    </div>

                    <div class="mt-12 bg-yellow-50 border-l-4 border-yellow-400 p-4">
                        <h5 class="font-bold text-yellow-800">ğŸ“Œ í•µì‹¬ ìš”ì•½ (Summary)</h5>
                        <p class="text-sm text-yellow-800 mt-1">${chapter.summary}</p>
                    </div>

                    <!-- Navigation Footer -->
                    <div class="flex justify-between mt-12 pt-6 border-t border-slate-200">
                        <button onclick="prevChapter()" class="px-4 py-2 bg-white border border-slate-300 rounded hover:bg-slate-50 text-sm ${index === 0 ? 'invisible' : ''}">
                            â† ì´ì „ ì±•í„°
                        </button>
                        <button onclick="nextChapter()" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 text-sm font-bold ${index === chapters.length - 1 ? 'invisible' : ''}">
                            ë‹¤ìŒ ì±•í„° â†’
                        </button>
                    </div>
                </div>
            `;

            // Initialize Interactions based on type
            setTimeout(() => {
                if (chapter.interactionType === 'windProfile') initWindChart();
                else if (chapter.interactionType === 'energyBudget') initEnergyChart();
                else if (chapter.interactionType === 'soilTemp') initSoilTempChart();
                else if (chapter.interactionType === 'turbulence') initTurbulenceChart();
                else if (chapter.interactionType === 'stability') initStabilityChart();
            }, 100);
        }

        function nextChapter() {
            if (currentChapterIndex < chapters.length - 1) {
                currentChapterIndex++;
                renderNav();
                loadChapter(currentChapterIndex);
            }
        }
        function prevChapter() {
            if (currentChapterIndex > 0) {
                currentChapterIndex--;
                renderNav();
                loadChapter(currentChapterIndex);
            }
        }

        // --- CHART FUNCTIONS ---

        // Chapter 6: Wind Profile
        function initWindChart() {
            const ctx = document.getElementById('windChart').getContext('2d');
            const slider = document.getElementById('roughnessSlider');
            const label = document.getElementById('roughnessLabel');

            const z = Array.from({length: 100}, (_, i) => (i + 1)); // Heights 1m to 100m
            const u_star = 0.5; // Friction velocity constant
            const k = 0.4; // Von Karman

            function calculateU(z0) {
                return z.map(height => (u_star / k) * Math.log(height / z0));
            }

            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: z, // Y-axis effectively
                    datasets: [{
                        label: 'í’ì† (Wind Speed, m/s)',
                        data: calculateU(0.01),
                        borderColor: '#4f46e5', // Indigo 600
                        borderWidth: 2,
                        fill: false,
                        pointRadius: 0,
                        tension: 0.4
                    }]
                },
                options: {
                    indexAxis: 'y', // Vertical profile
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: { display: true, text: 'í’ì† u (m/s)' },
                            min: 0, max: 20
                        },
                        y: {
                            title: { display: true, text: 'ë†’ì´ z (m)' }
                        }
                    },
                    plugins: {
                        tooltip: { mode: 'index', intersect: false }
                    }
                }
            });
            chartInstance = chart;

            slider.addEventListener('input', (e) => {
                const z0_val = e.target.value / 1000; // 0.001 to 0.1
                label.innerText = `${z0_val} m`;
                
                chart.data.datasets[0].data = calculateU(z0_val);
                chart.update('none'); // Update without animation for performance
            });
        }

        // Chapter 2: Energy Budget
        function initEnergyChart() {
            const ctx = document.getElementById('energyChart').getContext('2d');
            const slider = document.getElementById('moistureSlider');
            const label = document.getElementById('moistureLabel');

            function getData(moisture) {
                // Moisture 0-100. 
                // High moisture -> High LE, Low H (Bowen ratio low)
                // Low moisture -> Low LE, High H (Bowen ratio high)
                
                const factor = moisture / 100;
                
                // Simplified diurnal cycle (sin wave)
                const hours = Array.from({length: 24}, (_, i) => i);
                const Rn = hours.map(h => {
                    if (h < 6 || h > 18) return -50;
                    return 600 * Math.sin((h - 6) * Math.PI / 12);
                });
                
                // G is roughly 10% of Rn
                const G = Rn.map(val => val * 0.1);
                
                // Available energy = Rn - G = H + LE
                const avail = Rn.map((r, i) => r - G[i]);
                
                // Partitioning
                const LE = avail.map(a => a * (0.1 + 0.8 * factor)); // Max 90% LE if wet
                const H = avail.map((a, i) => a - LE[i]);

                return { hours, Rn, G, H, LE };
            }

            const initialData = getData(50);

            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: initialData.hours.map(h => `${h}ì‹œ`),
                    datasets: [
                        { label: 'ìˆœë³µì‚¬ (Rn)', data: initialData.Rn, borderColor: '#fbbf24', borderWidth: 3, pointRadius: 0 },
                        { label: 'ì ì—´ (LE)', data: initialData.LE, borderColor: '#3b82f6', borderWidth: 2, pointRadius: 0 },
                        { label: 'í˜„ì—´ (H)', data: initialData.H, borderColor: '#ef4444', borderWidth: 2, pointRadius: 0 },
                        { label: 'ì§€ì¤‘ì—´ (G)', data: initialData.G, borderColor: '#10b981', borderWidth: 2, pointRadius: 0 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { title: { display: true, text: 'Flux (W/mÂ²)' } }
                    },
                    interaction: { mode: 'index', intersect: false }
                }
            });
            chartInstance = chart;

            slider.addEventListener('input', (e) => {
                const val = e.target.value;
                if(val < 30) label.innerText = "ê±´ì¡° (Dry)";
                else if(val > 70) label.innerText = "ìŠµìœ¤ (Wet)";
                else label.innerText = "ë³´í†µ";

                const newData = getData(val);
                chart.data.datasets[1].data = newData.LE;
                chart.data.datasets[2].data = newData.H;
                chart.update('none');
            });
        }

        // Chapter 4: Soil Temp
        function initSoilTempChart() {
            const ctx = document.getElementById('soilTempChart').getContext('2d');
            
            // Generate data for depths 0, 0.2, 0.5m
            const hours = Array.from({length: 48}, (_, i) => i); // 2 days
            
            function getTemp(z) {
                const T_avg = 15;
                const A0 = 10;
                const D = 0.2; // Damping depth
                const omega = (2 * Math.PI) / 24;
                
                return hours.map(t => {
                    return T_avg + A0 * Math.exp(-z/D) * Math.sin(omega * t - z/D);
                });
            }

            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: hours.map(h => `+${h}h`),
                    datasets: [
                        { label: 'ì§€í‘œë©´ (0m)', data: getTemp(0), borderColor: '#dc2626', tension: 0.4, pointRadius: 0 },
                        { label: '0.2m ê¹Šì´', data: getTemp(0.2), borderColor: '#ea580c', tension: 0.4, pointRadius: 0 },
                        { label: '0.5m ê¹Šì´', data: getTemp(0.5), borderColor: '#1e40af', tension: 0.4, pointRadius: 0 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { title: { display: true, text: 'ì˜¨ë„ (Â°C)' } },
                        x: { title: { display: true, text: 'ì‹œê°„ ê²½ê³¼' }, ticks: { maxTicksLimit: 12 } }
                    }
                }
            });
            chartInstance = chart;
        }

        // Chapter 8: Turbulence
        function initTurbulenceChart() {
            const ctx = document.getElementById('turbulenceChart').getContext('2d');
            
            // Create synthetic turbulent signal
            const points = 200;
            const mean = 5;
            const data = [];
            for(let i=0; i<points; i++) {
                // Mean + Random Fluctuation (u')
                data.push(mean + (Math.random() - 0.5) * 4);
            }
            const meanLine = Array(points).fill(mean);

            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: points}, (_,i) => i),
                    datasets: [
                        { 
                            label: 'ìˆœê°„ í’ì† u (Instantaneous)', 
                            data: data, 
                            borderColor: '#94a3b8', 
                            borderWidth: 1, 
                            pointRadius: 0 
                        },
                        { 
                            label: 'í‰ê·  í’ì† <u> (Mean)', 
                            data: meanLine, 
                            borderColor: '#ef4444', 
                            borderWidth: 2, 
                            pointRadius: 0,
                            borderDash: [5, 5] 
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: false,
                    scales: {
                        y: { title: { display: true, text: 'í’ì† (m/s)' }, min: 0, max: 10 },
                        x: { display: false }
                    }
                }
            });
            chartInstance = chart;
        }

        // Chapter 11: Stability
        function initStabilityChart() {
            const ctx = document.getElementById('stabilityChart').getContext('2d');
            
            // Richardson number regimes
            const chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ê°•í•œ ë¶ˆì•ˆì • (Free Conv.)', 'ì•½í•œ ë¶ˆì•ˆì •', 'ì¤‘ë¦½ (Neutral)', 'ì•ˆì • (Stable)', 'ë§¤ìš° ì•ˆì •'],
                    datasets: [{
                        label: 'Richardson Number (Ri)',
                        data: [-1, -0.1, 0, 0.1, 0.5],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.6)', // Red
                            'rgba(251, 146, 60, 0.6)', // Orange
                            'rgba(203, 213, 225, 0.6)', // Grey
                            'rgba(59, 130, 246, 0.6)', // Blue
                            'rgba(30, 64, 175, 0.6)'  // Dark Blue
                        ]
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (ctx) => {
                                    if(ctx.raw > 0.25) return "Ri > 0.25: ë‚œë¥˜ ì†Œë©¸ (Laminar)";
                                    if(ctx.raw < 0) return "Ri < 0: ë¶€ë ¥ì— ì˜í•œ ë‚œë¥˜ ìƒì„±";
                                    return "ê¸°ê³„ì  ë‚œë¥˜ ìš°ì„¸";
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            title: { display: true, text: 'Bulk Richardson Number (Rb)' },
                            grid: { color: (ctx) => ctx.tick.value === 0 ? '#000' : '#e2e8f0', lineWidth: (ctx) => ctx.tick.value === 0 ? 2 : 1 }
                        }
                    }
                }
            });
            chartInstance = chart;
        }

        // --- INITIALIZATION ---
        window.addEventListener('DOMContentLoaded', () => {
            renderNav();
            loadChapter(0);

            // Mobile menu events
            mobileMenuBtn.addEventListener('click', () => toggleMobileMenu(true));
            closeMenuBtn.addEventListener('click', () => toggleMobileMenu(false));
        });

    </script>
</body>
</html>
